# 모듈과 리펙토링

module.py

```python
import cgi, os

def getList():
  files = os.listdir('data/')
  listStr = ''
  for item in files:
    if item != 'WEB':
      listStr = listStr + '<li><a href="index.py?id={id}">{id}</a></li>'.format(id=item)
  return listStr

def classification():
  form = cgi.FieldStorage()
  if 'id' in form:
    pageId = form['id'].value
    update_link = '<a href = "update.py?id={}">update</a>'.format(pageId)
    delete_action = '''
      <form action="process_delete.py" method="post">
        <input type="hidden" name="pageId" value="{}">
        <input type="submit" value="delete">
      </form>
    '''.format(pageId)
  else:
    pageId = 'WEB'
    update_link = ''
    delete_action = ''
  create_list = '<a href = "create.py">create</a>'
  description = open('data/'+pageId, 'r', encoding='utf-8').read()
    
  return {'pageId':pageId, 'update':update_link,
          'delete':delete_action, 'create': create_list,
          'desc': description}
```

index.py

```python
#!/usr/bin/python3

print("content-type: text/html; charset=utf-8")
print()
import cgi, os, module

print('''
<!doctype html>
<html>
<head>
  <title>WEB1 - Welcome</title>
  <meta charset="utf-8">
</head>

<body>
  <h1><a href="index.py">WEB</a></h1>
  <ol>{list}</ol>
  {create}
  {update}
  {delete}
  <h2>{title}</h2>
  <p>{desc}</p>
</body>

'''.format(title = module.classification()['pageId'], desc = module.classification()['desc'], 
           list = module.getList(), create = module.classification()['create'],
           update = module.classification()['update'], delete = module.classification()['delete']))

```

- index.py 뿐 아니라 update.py와 create.py까지 기능 중복이 다수 발생
- 위의 기능은 코드 간에 빈번하게 중복될 뿐 아니라, 하나의 코드 내에도 여러 곳에 분포되어 리소스 뿐 아니라, 유지보수 측면에서 비효율적임
- 동일한 기능을 별도의 `module.py` 폴더에 구현하고, 각 기능을 import 하는 방식으로 효율성을 개선
- 이렇듯 기능의 변화 없이 모듈화 하고 효율성을 높이는 작업을 refactoring이라고 함 (동작의 변화 없이 소프트웨어의 구조를 변경)